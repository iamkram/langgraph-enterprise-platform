graph TB
    User[User Request]
    
    subgraph "Layer 1: Authentication"
        OAuth[Manus OAuth<br/>JWT Validation]
        Session[Session Cookie<br/>HTTP-Only + Secure]
    end
    
    subgraph "Layer 2: Authorization"
        RBAC[Role-Based Access Control<br/>Admin vs User]
        Protected[Protected Procedures<br/>ctx.user validation]
    end
    
    subgraph "Layer 3: Input Validation"
        Zod[Zod Schema Validation<br/>Type-safe inputs]
        Sanitize[Input Sanitization<br/>XSS Prevention]
    end
    
    subgraph "Data Protection"
        Encrypt[Encryption at Rest<br/>RDS + S3]
        TLS[TLS 1.3<br/>In Transit]
        Secrets[Secrets Manager<br/>API Keys]
    end
    
    subgraph "Monitoring & Audit"
        Logs[CloudWatch Logs<br/>All API Calls]
        Alerts[Security Alerts<br/>Failed Auth]
        Audit[Audit Trail<br/>User Actions]
    end
    
    User --> OAuth
    OAuth --> Session
    Session --> RBAC
    RBAC --> Protected
    Protected --> Zod
    Zod --> Sanitize
    
    Sanitize --> Encrypt
    Sanitize --> TLS
    Sanitize --> Secrets
    
    OAuth --> Logs
    RBAC --> Logs
    Protected --> Logs
    
    Logs --> Alerts
    Logs --> Audit
    
    style OAuth fill:#ef4444,color:#fff
    style RBAC fill:#f59e0b,color:#fff
    style Zod fill:#10b981,color:#fff
    style Encrypt fill:#3b82f6,color:#fff
    style Logs fill:#8b5cf6,color:#fff
